# 3.3 平衡查找树

前几种算法在最坏情况下的性能还是很糟糕。本节中介绍一种二分查找树并能保证无论如何构造它，它的运行时间都是对数级别的。

理想情况下，我们希望能够保持二分查找树的平衡性，以使树高为 ~lgN，这样就能保证所有查找都能在 ~lgN 次比较内结束。

## 2-3 查找树

**定义**：一棵 **2-3 查找树**或为一棵空树，或由以下结点组成：

* **2-结点**，含有一个键（及其对应的值）和两条链接，左链接指向的 2-3 树中的键都小于该结点，右链接指向的 2-3 树中的键都大于该结点；
* **3-结点**，含有两个键（及其对应的值）和三条链接，左链接指向的 2-3 树中的键都小于该结点，**中链接**指向的 2-3 树中的键都位于该结点的两个键之间，右链接指向的 2-3 树中的键都大于该结点。

将指向一棵空树的链接称为**空链接**，一棵**完美平衡**的 2-3 查找树中的所有空链接到根结点的距离都应该是相同的。

### 插入

在一棵大小为 N 的 2-3 树中，查找和插入操作访问的结点必然不超过 lgN 个。

## 

尽管可以用不同的数据类型表示 2-结点和 3-结点，但这种直白的表示方法需要维护两种不同类型不同类型的结点，将被查找的键和结点中的每个键进行比较，将链接和其中信息从一种结点复制到另一种结点，

## 红黑二叉查找树

**定义**：**红黑树**是含有红黑链接并满足下列条件的二叉查找树：

* 红链接均为左链接；
* 没有任何一个结点同时和两条红链接相连；
* 该树是**完美黑色平衡**的，即任意空链接到根结点的路径上的黑链接数量相同。

**红链接**将两个 2-结点连接起来构成一个 3-结点，**黑链接**则是 2-3 树中的普通链接。确切来说，3-结点被表示为由一条**左斜**的红色链接相连的两个 2-结点（其中一个是另一个的左子结点）。

## 各种符号表实现的成本总结

| 算法（数据结构） | N 次插入后最坏情况下的查找成本 | N 次插入后最坏情况下的插入成本 | N 次随机插入后平均情况下的查找成本 | N 次随机插入后平均情况下的查找成本 | 是否高效支持有序性相关的操作
| :----: | :----: | :----: | :----: | :----: | :----: |
| 顺序查找（无序链表） | N | N | N/2 | N | 否
| 二分查找（有序数组） | lgN | 2N | lgN | N | 是
| 二叉树查找（BST） | N | N | 1.39lgN | 1.39lgN | 是
| 2-3 树查找（红黑树） | 2lgN | 2lgN | lgN | lgN | 是
